{% set version = "0.8.0.dev2" %}

package:
  name: ecole
  version: {{ version }}

source:
  url: https://github.com/ds4dm/ecole/archive/v{{ version }}.tar.gz
  sha256: 7926c17edda5bd27ca23808029f28e00d42a15b39bce43a657af79e412446b1e

build:
  number: 0
  skip: true  # [win]

requirements:
  build:
    - {{ compiler('cxx') }}
    - cmake >=3.15
    - ninja
  host:
    - scip
    - fmt
    - xtensor
    - xsimd
    - python
    - pip
    - scikit-build
    - pybind11 >=2.7
    - numpy >=1.11
    - xtensor-python

outputs:

  - name: libecole
    version: "{{ version }}"
    build:
      run_exports:
        - {{ pin_subpackage('libecole', exact=True) }}
    requirements:
      build:
        - {{ compiler('cxx') }}
        - cmake >=3.15
        - ninja
      host:
        - scip
        - fmt
        - xtensor
        - xsimd
      run:
        - __osx >={{ MACOSX_DEPLOYMENT_TARGET|default("10.9") }}  # [osx and x86_64]
      run_constrained:
        - pin_compatible('xtensor')
    files:
      - "include/ecole"
      - "lib/libecole*"
      - "lib/cmake/Ecole"
    test:
      script: test-libecole.sh
      source_files:
        - "examples/libecole/"
      requires:
        - {{ compiler('cxx') }}
        - cmake >=3.15
        - ninja
        - xsimd
        - xtensor

  - name: ecole
    version: "{{ version }}"
    requirements:
      build:
        - {{ compiler('cxx') }}
        - cmake >=3.15
        - ninja
      host:
        - scip
        - fmt
        - xtensor
        - xsimd
        - python
        - pip
        - scikit-build
        - pybind11 >=2.7
        - numpy >=1.11
        - xtensor-python
      run:
        - {{ pin_subpackage('libecole', exact=True) }}
        - __osx >={{ MACOSX_DEPLOYMENT_TARGET|default("10.9") }}  # [osx and x86_64]
        - python
        - numpy
      run_constrained:
        - pyscipopt >=3.0.1
    script: install_ecole.sh
    test:
      imports:
        - ecole
        - ecole.reward
        - ecole.environment
      commands:
        - "python -c 'import ecole; next(ecole.instance.SetCoverGenerator())'"

about:
  home: https://www.ecole.ai/
  license: BSD-3-Clause
  license_file: LICENSE
  summary: Extensible Combinatorial Optimization Learning Environments
  doc_url: https://doc.ecole.ai/

extra:
  recipe-maintainers:
    - AntoinePrv
    - gasse
